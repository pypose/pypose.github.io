<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pypose.module.System &mdash; PyPose 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/katex-math.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
        <script src="../../_static/katex_autorenderer.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="pypose.module.LTI" href="../pypose.module.LTI/" />
    <link rel="prev" title="pypose.module.IMUPreintegrator" href="../pypose.module.IMUPreintegrator/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../" class="icon icon-home"> PyPose
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../lietensor/">LieTensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basics/">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../convert/">Convert</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../modules/">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../pypose.module.IMUPreintegrator/">pypose.module.IMUPreintegrator</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pypose.module.System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pypose.module.LTI/">pypose.module.LTI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../optim/">Optimization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">PyPose</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../modules/">Modules</a> &raquo;</li>
      <li>pypose.module.System</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/generated/pypose.module.System.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pypose-module-system">
<h1>pypose.module.System<a class="headerlink" href="#pypose-module-system" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pypose.module.System">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypose.module.</span></span><span class="sig-name descname"><span class="pre">System</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pypose/module/dynamics/#System"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypose.module.System" title="Permalink to this definition"></a></dt>
<dd><p>The class for the simulation and linearization of general time-discrete time-varying dynamics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">boolean</span></code>) – Whether the system is time-varying; defaults to False, meaning time-invariant</p>
</dd>
</dl>
<p><strong>Governing Equation</strong></p>
<p>The general state-space equation is given as:</p>
<div class="math">
\[\begin{align}
\mathbf{x}_{k+1} &= \mathbf{f}(\mathbf{x}_k,\mathbf{u}_k,t_k) \\
\mathbf{y}_{k} &= \mathbf{g}(\mathbf{x}_k,\mathbf{u}_k,t_k)
\end{align}

\]</div>
<p>where <span class="math">\(k\)</span> is the time step; <span class="math">\(\mathbf{x}\)</span>, <span class="math">\(\mathbf{u}\)</span>,
<span class="math">\(\mathbf{y}\)</span> are the states, inputs and observations, respectively;
<span class="math">\(\mathbf{f}\)</span> and <span class="math">\(\mathbf{g}\)</span> are
the state transition and observation functions, respectively.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we choose to work with a time-discrete system, since typically in numerical simulations and
control applications, the dynamical systems are usually discretized in time.</p>
</div>
<p>To use the class, the user should define two methods <a class="reference internal" href="#pypose.module.System.state_transition" title="pypose.module.System.state_transition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_transition</span></code></a> and <a class="reference internal" href="#pypose.module.System.observation" title="pypose.module.System.observation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">observation</span></code></a>, which are
used in the <a class="reference internal" href="#pypose.module.System.forward" title="pypose.module.System.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a> method.  The <a class="reference internal" href="#pypose.module.System.forward" title="pypose.module.System.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a> method advances the dynamical system by one time step, and
is the function that is back-propagated in the learning process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#pypose.module.System.forward" title="pypose.module.System.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a> method implicitly increments the time step via <code class="xref py py-obj docutils literal notranslate"><span class="pre">forward_hook</span></code>.  As a result, in the
implementations of <a class="reference internal" href="#pypose.module.System.state_transition" title="pypose.module.System.state_transition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_transition</span></code></a> and <a class="reference internal" href="#pypose.module.System.observation" title="pypose.module.System.observation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">observation</span></code></a>, one does not need to include the time as
the input; instead, one can directly access the current time via the data member <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.t</span></code>.</p>
</div>
<p><strong>Linearization</strong></p>
<p>This class provides a means to linearize the system at a reference point <span class="math">\(\chi^*=(\mathbf{x}^*,\mathbf{u}^*,t^*)\)</span>
along a trajectory.  Consider a point <span class="math">\(\chi=(\mathbf{x}^*+\delta\mathbf{x},\mathbf{u}^*+\delta\mathbf{u},t^*)\)</span>
near <span class="math">\(\chi^*\)</span>.  The goal is to obtain a linear dynamics model for <span class="math">\(\chi\)</span> that behaves
similarly to the nonlinear dynamics when <span class="math">\(||\delta\mathbf{x}||\)</span> and <span class="math">\(||\delta\mathbf{u}||\)</span> are sufficiently
small.</p>
<p>The linearization process is the same for <span class="math">\(\mathbf{f}\)</span> and <span class="math">\(\mathbf{g}\)</span>, so we only present
the case for <span class="math">\(\mathbf{f}\)</span> in detail below.
Ignoring the higher order terms, the Taylor series expansion of <span class="math">\(\mathbf{f}\)</span> at the reference point
<span class="math">\(\chi^*\)</span> is</p>
<div class="math">
\[\begin{aligned}
\mathbf{f}(\mathbf{x},\mathbf{u},t^*) &\approx \mathbf{f}(\mathbf{x}^*,\mathbf{u}^*,t^*) +
                        \left. \frac{\partial \mathbf{f}}{\partial \mathbf{x}} \right|_{\chi^*} \delta \mathbf{x} +
                        \left. \frac{\partial \mathbf{f}}{\partial \mathbf{u}} \right|_{\chi^*} \delta \mathbf{u} \\
&= \mathbf{f}(\mathbf{x}^*,\mathbf{u}^*,t^*) + \mathbf{A}(\mathbf{x}-\mathbf{x}^*) + \mathbf{B}(\mathbf{u}-\mathbf{u}^*) \\
&= \mathbf{A}\mathbf{x} + \mathbf{B}\mathbf{u} + \mathbf{c}_1
\end{aligned}

\]</div>
<p>where we have introduced,</p>
<div class="math">
\[\mathbf{A} = \left. \frac{\partial \mathbf{f}}{\partial \mathbf{x}} \right|_{\chi^*},\quad
\mathbf{B} = \left. \frac{\partial \mathbf{f}}{\partial \mathbf{u}} \right|_{\chi^*},\quad
\mathbf{c}_1 = \mathbf{f}(\mathbf{x}^*,\mathbf{u}^*,t^*) - \mathbf{A}\mathbf{x}^* - \mathbf{B}\mathbf{u}^*

\]</div>
<p>Similarly, one can linearize <span class="math">\(\mathbf{g}\)</span> as</p>
<div class="math">
\[\mathbf{g}(\mathbf{x},\mathbf{u},t^*) \approx \mathbf{C}\mathbf{x} + \mathbf{D}\mathbf{u} + \mathbf{c}_2

\]</div>
<p>where</p>
<div class="math">
\[\mathbf{C} = \left. \frac{\partial \mathbf{g}}{\partial \mathbf{x}} \right|_{\chi^*},\quad
\mathbf{D} = \left. \frac{\partial \mathbf{g}}{\partial \mathbf{u}} \right|_{\chi^*},\quad
\mathbf{c}_2 = \mathbf{g}(\mathbf{x}^*,\mathbf{u}^*,t^*) - \mathbf{C}\mathbf{x}^* - \mathbf{D}\mathbf{u}^*

\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The notion of linearization is slightly different from that in dynamical system theory.
First, the linearization is done for any arbitrary point, not just at the equilibrium point(s), and
therefore the extra constant terms <span class="math">\(\mathbf{c}_1\)</span> and <span class="math">\(\mathbf{c}_2\)</span> are produced.
Second, the linearized equations are written for the full states and inputs, <span class="math">\(\mathbf{x}\)</span> and <span class="math">\(\mathbf{u}\)</span>,
instead of their perturbation terms, <span class="math">\(\delta \mathbf{x}\)</span> and <span class="math">\(\delta \mathbf{u}\)</span>
so that the model is consistent with, e.g., the LTI model and the iterative LQR solver.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="pypose.module.System.A">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">A</span></span><a class="headerlink" href="#pypose.module.System.A" title="Permalink to this definition"></a></dt>
<dd><p>State matrix for linear/linearized system (<span class="math">\(\mathbf{A}\)</span>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pypose.module.System.B">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">B</span></span><a class="headerlink" href="#pypose.module.System.B" title="Permalink to this definition"></a></dt>
<dd><p>Input matrix for linear/linearized system (<span class="math">\(\mathbf{B}\)</span>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pypose.module.System.C">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">C</span></span><a class="headerlink" href="#pypose.module.System.C" title="Permalink to this definition"></a></dt>
<dd><p>Output matrix for linear/linearized system (<span class="math">\(\mathbf{C}\)</span>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pypose.module.System.D">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">D</span></span><a class="headerlink" href="#pypose.module.System.D" title="Permalink to this definition"></a></dt>
<dd><p>Feedthrough matrix for linear/linearized system (<span class="math">\(\mathbf{D}\)</span>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pypose.module.System.c1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c1</span></span><a class="headerlink" href="#pypose.module.System.c1" title="Permalink to this definition"></a></dt>
<dd><p>Constant term generated by state-transition (<span class="math">\(\mathbf{c}_1\)</span>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pypose.module.System.c2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c2</span></span><a class="headerlink" href="#pypose.module.System.c2" title="Permalink to this definition"></a></dt>
<dd><p>Constant term generated by observation (<span class="math">\(\mathbf{c}_2\)</span>)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypose.module.System.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pypose/module/dynamics/#System.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypose.module.System.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The state of the dynamical system</p></li>
<li><p><strong>input</strong> (<em>Tensor</em>) – The input to the dynamical system</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>new_state</strong> (<em>Tensor</em>) – The state of the system at next time step</p></li>
<li><p><strong>observation</strong> (<em>Tensor</em>) – The observation of the system at the current step</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypose.module.System.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pypose/module/dynamics/#System.observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypose.module.System.observation" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The state of the dynamical system</p></li>
<li><p><strong>input</strong> (<em>Tensor</em>) – The input to the dynamical system</p></li>
<li><p><strong>Note</strong> – One can access the current time via the data member <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.t</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>observation</strong> – The observation of the system at the current step</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypose.module.System.set_linearization_point">
<span class="sig-name descname"><span class="pre">set_linearization_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pypose/module/dynamics/#System.set_linearization_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypose.module.System.set_linearization_point" title="Permalink to this definition"></a></dt>
<dd><p>Function to set the point about which the system is to be linearized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The state of the dynamical system</p></li>
<li><p><strong>input</strong> (<em>Tensor</em>) – The input to the dynamical system</p></li>
<li><p><strong>t</strong> (<em>Tensor</em>) – The time step of the dynamical system</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypose.module.System.state_transition">
<span class="sig-name descname"><span class="pre">state_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pypose/module/dynamics/#System.state_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pypose.module.System.state_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The state of the dynamical system</p></li>
<li><p><strong>input</strong> (<em>Tensor</em>) – The input to the dynamical system</p></li>
<li><p><strong>Note</strong> – One can access the current time via the data member <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.t</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_state</strong> – The state of the system at next time step</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../pypose.module.IMUPreintegrator/" class="btn btn-neutral float-left" title="pypose.module.IMUPreintegrator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../pypose.module.LTI/" class="btn btn-neutral float-right" title="pypose.module.LTI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, PyPose Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>